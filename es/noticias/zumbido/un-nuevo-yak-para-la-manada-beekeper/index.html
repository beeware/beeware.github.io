<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Un nuevo yak para el rebaño: BeeKeeper— BeeWare</title>

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/images/brutus-144.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/static/images/brutus-114.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/static/images/brutus-72.png">
    <link rel="apple-touch-icon-precomposed" href="/static/images/brutus-57.png">
    <link rel="shortcut icon" href="/static/images/brutus-32.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="/static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/static/bootstrap/css/bootstrap-grid.min.css">

    <!-- Project CSS -->
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Cutive">
    <link rel="stylesheet" type="text/css" href="/static/beeware.css"><!-- Project CSS --><style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
</style><!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/078c86a30a.js" crossorigin="anonymous"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2943925-4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-2943925-4');
    </script></head>
  <body>

  <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
  <div class="nav-top">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsDefault" aria-controls="navbarsDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="navbar-brand-block">
      <a class="navbar-brand" href="/es/"><img class="mx-2" src="/static/images/brutus-32.png?h=e18afe42">BeeWare</a>
    </div>
  </div>
  <div class="collapse navbar-collapse" id="navbarsDefault">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item">
    <a class="nav-link" href="/es/acerca-de/">
Acerca
</a>
  </li>
      <li class="nav-item">
    <a class="nav-link" href="/es/project/">
Proyectos
</a>
  </li>
      <li class="nav-item">
    <a class="nav-link" href="/es/comunidad/">
Comunidad
</a>
  </li>
      <li class="nav-item">
    <a class="nav-link" href="/es/contributing/">
Contribuir
</a>
  </li>
      <li class="nav-item active">
    <a class="nav-link" href="/es/noticias/">
Noticias
<span class="sr-only">(current)</span></a>
  </li>
      <li class="nav-item">
        <a class="nav-link" href=/es/membresia/>
          
Donar

        </a>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right"><li class="nav-item"><a class="nav-link" href="https://github.com/beeware/beeware.github.io/edit/lektor/content/news/buzz/a-new-yak-for-the-herd-beekeeper/contents%2Bes.lr" rel="noopener noreferrer" target="_blank">
            <i class="fa fa-github "></i><small>&nbsp;
Editar en GitHub
</small>
          </a></li>
     <li class="nav-item dropdown dropdown-pull-right">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
          <i class="fa fa-globe" aria-hidden="true"></i> <span class="caret"></span>
        </a>
        <div class="dropdown-menu" aria-labelledby="dropdown01">
          <a class="dropdown-item " href="/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          English
          </a><a class="dropdown-item " href="/ar_AR/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
العَرَبِيَّة

          </a><a class="dropdown-item " href="/cs_CZ/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
Čeština

          </a><a class="dropdown-item " href="/da_DK/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
Dansk

          </a><a class="dropdown-item " href="/de_DE/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
Deutsch

          </a><a class="dropdown-item active" href="/es/noticias/zumbido/un-nuevo-yak-para-la-manada-beekeper/">
          
Español

          </a><a class="dropdown-item " href="/fa_IR/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
فارسی

          </a><a class="dropdown-item " href="/fr_FR/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
Français

          </a><a class="dropdown-item " href="/it_IT/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
Italiano

          </a><a class="dropdown-item " href="/ko_KR/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
한국어

          </a><a class="dropdown-item " href="/pl_PL/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
Polski

          </a><a class="dropdown-item " href="/pt_BR/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
Português

          </a><a class="dropdown-item " href="/tr_TR/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
Türkçe

          </a><a class="dropdown-item " href="/zh_CN/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
中文(简体)

          </a><a class="dropdown-item " href="/zh_TW/news/buzz/a-new-yak-for-the-herd-beekeeper/">
          
中文(繁體)

          </a></div>
      </li>

    </ul>
  </div>
  </nav>
    <div class="content">
<div class="banner">
  <div class="container">
    <p>
  

  
  
  

  
  
  

  
  <a href="/es/">
Inicio
</a>
  
 >
  <a href="/es/noticias/">Noticias</a>
  
 >
  <a href="/es/noticias/zumbido/">El Zumbido</a>
  
</p>
    <h1>Un nuevo yak para el rebaño: BeeKeeper</h1>
    <p>
Publicado por

        
        <a href="https://cloudisland.nz/@freakboy3742">Russell Keith-Magee</a>
        
        
en
 2017/07/31
    </p>
  </div>
</div>
<div class="container"><div class="alert alert-warning">
          <i class="fa fa-warning"></i>&nbsp;
El contenido y/o traducción de esta página puede estar desactualizado!
&nbsp;&nbsp;
          <a href="/news/buzz/a-new-yak-for-the-herd-beekeeper/" data-toggle="modal" data-target="#myModal">
Ver que ha cambiado
</a>
        </div>

        <!-- Modal -->
        <div id="myModal" class="modal fade" role="dialog">
          <div class="modal-dialog modal-lg">

            <!-- Modal content-->
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">
                  <a href="https://github.com/beeware/beeware.github.io/edit/lektor/content/news/buzz/a-new-yak-for-the-herd-beekeeper/contents%2Bes.lr" target="_blank">
                    <i class="fa fa-github "></i>&nbsp;
Actualizar el contenido en Github

                  </a>
                </h4>
              </div>
              <div class="modal-body">
                <small><div class="highlight"><pre><span></span><span class="gh">diff --git a/content/news/buzz/a-new-yak-for-the-herd-beekeeper/contents.lr b/content/news/buzz/a-new-yak-for-the-herd-beekeeper/contents.lr</span>
<span class="gh">index 423fcffd6e..3a3976bb0e 100644</span>
<span class="gd">--- a/content/news/buzz/a-new-yak-for-the-herd-beekeeper/contents.lr</span>
<span class="gi">+++ b/content/news/buzz/a-new-yak-for-the-herd-beekeeper/contents.lr</span>
<span class="gu">@@ -4,55 +4,168 @@ author: Russell Keith-Magee</span>
<span class="w"> </span>---
<span class="w"> </span>body:
<span class="w"> </span>
<span class="gd">-Testing is a skill that is a vital part of every programmers training. Learning how to write good tests helps you write more robust code, and ensures that when you&#39;ve written code that works, it keeps working long into the future. It can also help you write better code in the first place. It turns out that well architected code, with high cohesion and low coupling, is also easy to test - so writing code that is easy to test will almost always result in better overall code quality.</span>
<span class="gd">-</span>
<span class="gd">-An important step in &quot;levelling up&quot; your testing experience is to start using a Continuous Integration, or CI service. A CI service is a tool that automatically runs your test suite every time someone makes a change - or every time someone proposes a change in the form of a pull request. Using a CI service makes sure that your code *always* passes your test suite - you can&#39;t accidentally slip in a change that breaks a test, because you&#39;ll get a big red warning notification.</span>
<span class="gd">-</span>
<span class="gd">-CI is such an important service that many companies exist solely to provide CI-as-a-service. The BeeWare project has, for various projects, used `TravisCI &lt;https://travis-ci.org&gt;`__ and `CircleCI &lt;https://circleci.com&gt;`__. Both these tools provide free tiers for open source projects, and have generously sponsored BeeWare with capacity upgrades at various times.</span>
<span class="gd">-</span>
<span class="gd">-However, the BeeWare has had an interesting relationship with commercial CI services. This is for two reasons.</span>
<span class="gd">-</span>
<span class="gd">-Firstly, our test suites - especially for `VOC &lt;/project/attic/voc&gt;`__ and `Batavia &lt;/project/attic/batavia&gt;`__ - take a long time to run. These two projects require tests that repeatedly start and shut down virtual machines (for Java and JavaScript, respectively), and no matter how much you optimize the code being tested, the startup and shutdown time of a virtual machine eventually adds up. We also need to run our test suites on multiple versions of Python - at present, we support Python 3.4, 3.5 and 3.6, with 3.7 on the horizon. There are also subtle changes in micro versions that may require testing.</span>
<span class="gd">-</span>
<span class="gd">-We&#39;ve been able to speed up the duration of a test run by splitting up the test suite and running parts of the suite in parallel, but that forces us up against the second problem. Commercial CI services usually operate on a subscription model; higher subscriptions providing more simultaneous resources. However, our usage pattern is highly unusual. Most of the year, we get a slow trickle of pull requests that require testing. However, a couple of times a year, we have a large sprint, and we have a flood of contributions over a short period of time. At PyCon US, we have had groups of 40 people submitting patches - and they all need their submissions tested by CI. And time is a factor - the sprints only last a couple of days, so a fast turnaround on testing is essential.</span>
<span class="gd">-</span>
<span class="gd">-If we were to subscribe to the top tier subscription levels of CircleCi and TravisCI, we still wouldn&#39;t have enough resources to support a sprint - but we&#39;d be *massively* overresourced for the rest of the year. We&#39;d also have to pay $750 or more a month for this service, which is a budget we can&#39;t afford.</span>
<span class="gd">-</span>
<span class="gd">-So - we had a problem. To run our test suite effectively, we needed massively parallelized resources to run a test suite quickly; and at certain times of the year, we need extremely large numbers of these resources.</span>
<span class="gd">-</span>
<span class="gd">-We also had other automated tasks that we wanted to perform. We wanted to do code linting (automated checking of code style) before a PR was tested. We wanted to check spelling of documentation. And we wanted these tasks to feed back into GitHub as automated comments and specific code review status markers, informing contributors not just that a problem occurred - but what problem occurred, and where in their code.</span>
<span class="gd">-</span>
<span class="gd">-We also wanted to manage pipeline builds - there&#39;s no point in doing a full test of multiple versions of Python once you&#39;ve established the tests are failing on one version. And there&#39;s no point testing *at all* if there are code style problems.</span>
<span class="gd">-</span>
<span class="gd">-We also wanted to do things that weren&#39;t just testing. We wanted to check that contributor agreements have been signed. We wanted to automate deployment of websites and documentation.</span>
<span class="gd">-</span>
<span class="gd">-What we had wasn&#39;t just a CI problem. It was a problem where we wanted to automatically run arbitrary code, in a safe way, in response to a GitHub event.</span>
<span class="gd">-</span>
<span class="gd">-I&#39;ve been trying to find a CI service that can meet our needs for over a year. But over the last year, a few thoughts started to congeal in my head.</span>
<span class="gd">-</span>
<span class="gd">-* Amazon provides a API (EC2) that allows you to spool up machines of varying complexity (up to 64 CPUs, with almost 500GB of RAM), and pay by the minute for that usage.</span>
<span class="gd">-* Docker provides the tools for configuring, launching, and running code in an isolated fashion</span>
<span class="gd">-* Amazon also provides an API (ECS) to control the execution of Docker containers.</span>
<span class="gd">-</span>
<span class="gd">-There&#39;s nothing specific about AWS EC2 or ECS either - you could just as easily use Linode and Kubernetes, or Docker Swarm, or Microsoft Azure... you just need to have the ability to easily spool up machines and run a Docker container. After all: a test suite is just a Docker container that runs a script that starts your test suite. A linting check is a Docker container that runs a script that lints your code. A contributor agreement check is a Docker container that checks the metadata associated with a pull request.</span>
<span class="gd">-</span>
<span class="gd">-All you need then is a website that can receive GitHub event notifications, and start Docker containers in response.</span>
<span class="gd">-</span>
<span class="gd">-At the start of July, I found myself between jobs, and uttered the fateful question &quot;How hard could it be?&quot; And so, today, I&#39;m announcing `BeeKeeper &lt;/project/attic/beekeeper&gt;`__ - BeeWare&#39;s own CI service.</span>
<span class="gd">-</span>
<span class="gd">-BeeKeeper deploys as a Heroku website, written using Django. After configuring it with Github and AWS credentials, it listens for Github webhooks. When a Pull Request or Push is detected, BeeKeeper creates a build request; that build request inspects the code in the repository looking for a ``beekeeper.yml`` configuration file. That configuration file describes the pipeline of tasks that will be performed, and for each task, the type of machine that should be used, any environment variables that are required, and the Docker image that will be used.</span>
<span class="gd">-</span>
<span class="gd">-BeeKeeper also allows the site admin to describe what resources will be used to satisfy builds. A task can say it needs a &quot;High CPU&quot; instance; but the BeeKeeper instance can determine what &quot;High CPU&quot; means - is it 4 CPUs or 32? When those machines are spooled up, how long will they be allowed to sit idle before being shut down again? How many machines should be sitting in the pool permanently? And what is the upper limit on machines that will be started?</span>
<span class="gd">-</span>
<span class="gd">-A companion tool to BeeKeeper is `Waggle &lt;/project/attic/waggle&gt;`__. Waggle is a tool that prepares a local definition of a task so it can be used by BeeKeeper - it compiles the Docker image, and uploads it into ECS so that it can be referenced by tasks. (It&#39;s called &quot;Waggle&quot; because when worker bees discover a good source of nectar, they return to the hive and do a `waggle dance &lt;https://en.wikipedia.org/wiki/Waggle_dance&gt;`__ that tells other bees how to find that source).</span>
<span class="gd">-</span>
<span class="gd">-We&#39;ve also provided a repository called `Comb &lt;https://github.com/beeware/comb&gt;`__ (named after honey comb, the place bees store all the nectar they find) that defines the task configurations that a BeeKeeper instance can use. We&#39;ve provided some simple definitions as part of the base Comb repository; each BeeKeeper deployment should have one of these repositories of it&#39;s own.</span>
<span class="gd">-</span>
<span class="gd">-There&#39;s still a lot of work to do, but we&#39;re already using BeeKeeper to Batavia and VOC, and the upcoming PyCon AU sprints will be our first outing under high-load conditions. Some back-of-envelope calculations predict that for around $50, we&#39;ll be able to provide enough CPU resources for each test run to complete running in 10 minutes or less, supporting a sprint of dozens of people.</span>
<span class="gd">-</span>
<span class="gd">-Although BeeKeeper was written to meet the needs of the BeeWare project, it&#39;s an open source tool available for anyone to use. If you&#39;d like to take BeeKeeper for a spin, come along to the sprints, or `check out the code on GitHub &lt;https://github.com/beeware/beekeeper&gt;`__.</span>
<span class="gd">-</span>
<span class="gd">-BeeKeeper is also an example of the sort of product you&#39;d see more of if BeeWare development was funded full time. I was able to build BeeKeeper because I had a spare couple of weeks between jobs. There is no end to the tools and libraries like BeeKeeper and Waggle that could be built to support the software development process - all that is missing is the resources needed to develop those tools. If you&#39;d like to see more tools like BeeKeeper in the world, please consider `joining the BeeWare project as a financial member &lt;/contributing/membership/&gt;`__. Every little bit helps, and if we can reach a critical mass of supporters, I&#39;ll be able to start working on BeeWare full time.</span>
<span class="gi">+Testing is a skill that is a vital part of every programmers training.</span>
<span class="gi">+Learning how to write good tests helps you write more robust code, and</span>
<span class="gi">+ensures that when you&#39;ve written code that works, it keeps working long</span>
<span class="gi">+into the future. It can also help you write better code in the first</span>
<span class="gi">+place. It turns out that well architected code, with high cohesion and</span>
<span class="gi">+low coupling, is also easy to test - so writing code that is easy to</span>
<span class="gi">+test will almost always result in better overall code quality.</span>
<span class="gi">+</span>
<span class="gi">+An important step in &quot;levelling up&quot; your testing experience is to start</span>
<span class="gi">+using a Continuous Integration, or CI service. A CI service is a tool</span>
<span class="gi">+that automatically runs your test suite every time someone makes a</span>
<span class="gi">+change - or every time someone proposes a change in the form of a pull</span>
<span class="gi">+request. Using a CI service makes sure that your code *always* passes</span>
<span class="gi">+your test suite - you can&#39;t accidentally slip in a change that breaks a</span>
<span class="gi">+test, because you&#39;ll get a big red warning notification.</span>
<span class="gi">+</span>
<span class="gi">+CI is such an important service that many companies exist solely to</span>
<span class="gi">+provide CI-as-a-service. The BeeWare project has, for various projects,</span>
<span class="gi">+used [TravisCI](https://travis-ci.org) and</span>
<span class="gi">+[CircleCI](https://circleci.com). Both these tools provide free tiers</span>
<span class="gi">+for open source projects, and have generously sponsored BeeWare with</span>
<span class="gi">+capacity upgrades at various times.</span>
<span class="gi">+</span>
<span class="gi">+However, the BeeWare has had an interesting relationship with commercial</span>
<span class="gi">+CI services. This is for two reasons.</span>
<span class="gi">+</span>
<span class="gi">+Firstly, our test suites - especially for [VOC](/project/attic/voc) and</span>
<span class="gi">+[Batavia](/project/attic/batavia) - take a long time to run. These two</span>
<span class="gi">+projects require tests that repeatedly start and shut down virtual</span>
<span class="gi">+machines (for Java and JavaScript, respectively), and no matter how much</span>
<span class="gi">+you optimize the code being tested, the startup and shutdown time of a</span>
<span class="gi">+virtual machine eventually adds up. We also need to run our test suites</span>
<span class="gi">+on multiple versions of Python - at present, we support Python 3.4, 3.5</span>
<span class="gi">+and 3.6, with 3.7 on the horizon. There are also subtle changes in micro</span>
<span class="gi">+versions that may require testing.</span>
<span class="gi">+</span>
<span class="gi">+We&#39;ve been able to speed up the duration of a test run by splitting up</span>
<span class="gi">+the test suite and running parts of the suite in parallel, but that</span>
<span class="gi">+forces us up against the second problem. Commercial CI services usually</span>
<span class="gi">+operate on a subscription model; higher subscriptions providing more</span>
<span class="gi">+simultaneous resources. However, our usage pattern is highly unusual.</span>
<span class="gi">+Most of the year, we get a slow trickle of pull requests that require</span>
<span class="gi">+testing. However, a couple of times a year, we have a large sprint, and</span>
<span class="gi">+we have a flood of contributions over a short period of time. At PyCon</span>
<span class="gi">+US, we have had groups of 40 people submitting patches - and they all</span>
<span class="gi">+need their submissions tested by CI. And time is a factor - the sprints</span>
<span class="gi">+only last a couple of days, so a fast turnaround on testing is</span>
<span class="gi">+essential.</span>
<span class="gi">+</span>
<span class="gi">+If we were to subscribe to the top tier subscription levels of CircleCi</span>
<span class="gi">+and TravisCI, we still wouldn&#39;t have enough resources to support a</span>
<span class="gi">+sprint - but we&#39;d be *massively* overresourced for the rest of the year.</span>
<span class="gi">+We&#39;d also have to pay $750 or more a month for this service, which is a</span>
<span class="gi">+budget we can&#39;t afford.</span>
<span class="gi">+</span>
<span class="gi">+So - we had a problem. To run our test suite effectively, we needed</span>
<span class="gi">+massively parallelized resources to run a test suite quickly; and at</span>
<span class="gi">+certain times of the year, we need extremely large numbers of these</span>
<span class="gi">+resources.</span>
<span class="gi">+</span>
<span class="gi">+We also had other automated tasks that we wanted to perform. We wanted</span>
<span class="gi">+to do code linting (automated checking of code style) before a PR was</span>
<span class="gi">+tested. We wanted to check spelling of documentation. And we wanted</span>
<span class="gi">+these tasks to feed back into GitHub as automated comments and specific</span>
<span class="gi">+code review status markers, informing contributors not just that a</span>
<span class="gi">+problem occurred - but what problem occurred, and where in their code.</span>
<span class="gi">+</span>
<span class="gi">+We also wanted to manage pipeline builds - there&#39;s no point in doing a</span>
<span class="gi">+full test of multiple versions of Python once you&#39;ve established the</span>
<span class="gi">+tests are failing on one version. And there&#39;s no point testing *at all*</span>
<span class="gi">+if there are code style problems.</span>
<span class="gi">+</span>
<span class="gi">+We also wanted to do things that weren&#39;t just testing. We wanted to</span>
<span class="gi">+check that contributor agreements have been signed. We wanted to</span>
<span class="gi">+automate deployment of websites and documentation.</span>
<span class="gi">+</span>
<span class="gi">+What we had wasn&#39;t just a CI problem. It was a problem where we wanted</span>
<span class="gi">+to automatically run arbitrary code, in a safe way, in response to a</span>
<span class="gi">+GitHub event.</span>
<span class="gi">+</span>
<span class="gi">+I&#39;ve been trying to find a CI service that can meet our needs for over a</span>
<span class="gi">+year. But over the last year, a few thoughts started to congeal in my</span>
<span class="gi">+head.</span>
<span class="gi">+</span>
<span class="gi">+- Amazon provides a API (EC2) that allows you to spool up machines of</span>
<span class="gi">+  varying complexity (up to 64 CPUs, with almost 500GB of RAM), and pay</span>
<span class="gi">+  by the minute for that usage.</span>
<span class="gi">+- Docker provides the tools for configuring, launching, and running code</span>
<span class="gi">+  in an isolated fashion</span>
<span class="gi">+- Amazon also provides an API (ECS) to control the execution of Docker</span>
<span class="gi">+  containers.</span>
<span class="gi">+</span>
<span class="gi">+There&#39;s nothing specific about AWS EC2 or ECS either - you could just as</span>
<span class="gi">+easily use Linode and Kubernetes, or Docker Swarm, or Microsoft Azure...</span>
<span class="gi">+you just need to have the ability to easily spool up machines and run a</span>
<span class="gi">+Docker container. After all: a test suite is just a Docker container</span>
<span class="gi">+that runs a script that starts your test suite. A linting check is a</span>
<span class="gi">+Docker container that runs a script that lints your code. A contributor</span>
<span class="gi">+agreement check is a Docker container that checks the metadata</span>
<span class="gi">+associated with a pull request.</span>
<span class="gi">+</span>
<span class="gi">+All you need then is a website that can receive GitHub event</span>
<span class="gi">+notifications, and start Docker containers in response.</span>
<span class="gi">+</span>
<span class="gi">+At the start of July, I found myself between jobs, and uttered the</span>
<span class="gi">+fateful question &quot;How hard could it be?&quot; And so, today, I&#39;m announcing</span>
<span class="gi">+[BeeKeeper](/project/attic/beekeeper) - BeeWare&#39;s own CI service.</span>
<span class="gi">+</span>
<span class="gi">+BeeKeeper deploys as a Heroku website, written using Django. After</span>
<span class="gi">+configuring it with Github and AWS credentials, it listens for Github</span>
<span class="gi">+webhooks. When a Pull Request or Push is detected, BeeKeeper creates a</span>
<span class="gi">+build request; that build request inspects the code in the repository</span>
<span class="gi">+looking for a `beekeeper.yml` configuration file. That configuration</span>
<span class="gi">+file describes the pipeline of tasks that will be performed, and for</span>
<span class="gi">+each task, the type of machine that should be used, any environment</span>
<span class="gi">+variables that are required, and the Docker image that will be used.</span>
<span class="gi">+</span>
<span class="gi">+BeeKeeper also allows the site admin to describe what resources will be</span>
<span class="gi">+used to satisfy builds. A task can say it needs a &quot;High CPU&quot; instance;</span>
<span class="gi">+but the BeeKeeper instance can determine what &quot;High CPU&quot; means - is it 4</span>
<span class="gi">+CPUs or 32? When those machines are spooled up, how long will they be</span>
<span class="gi">+allowed to sit idle before being shut down again? How many machines</span>
<span class="gi">+should be sitting in the pool permanently? And what is the upper limit</span>
<span class="gi">+on machines that will be started?</span>
<span class="gi">+</span>
<span class="gi">+A companion tool to BeeKeeper is [Waggle](/project/attic/waggle). Waggle</span>
<span class="gi">+is a tool that prepares a local definition of a task so it can be used</span>
<span class="gi">+by BeeKeeper - it compiles the Docker image, and uploads it into ECS so</span>
<span class="gi">+that it can be referenced by tasks. (It&#39;s called &quot;Waggle&quot; because when</span>
<span class="gi">+worker bees discover a good source of nectar, they return to the hive</span>
<span class="gi">+and do a [waggle dance](https://en.wikipedia.org/wiki/Waggle_dance) that</span>
<span class="gi">+tells other bees how to find that source).</span>
<span class="gi">+</span>
<span class="gi">+We&#39;ve also provided a repository called</span>
<span class="gi">+[Comb](https://github.com/beeware/comb) (named after honey comb, the</span>
<span class="gi">+place bees store all the nectar they find) that defines the task</span>
<span class="gi">+configurations that a BeeKeeper instance can use. We&#39;ve provided some</span>
<span class="gi">+simple definitions as part of the base Comb repository; each BeeKeeper</span>
<span class="gi">+deployment should have one of these repositories of it&#39;s own.</span>
<span class="gi">+</span>
<span class="gi">+There&#39;s still a lot of work to do, but we&#39;re already using BeeKeeper to</span>
<span class="gi">+Batavia and VOC, and the upcoming PyCon AU sprints will be our first</span>
<span class="gi">+outing under high-load conditions. Some back-of-envelope calculations</span>
<span class="gi">+predict that for around $50, we&#39;ll be able to provide enough CPU</span>
<span class="gi">+resources for each test run to complete running in 10 minutes or less,</span>
<span class="gi">+supporting a sprint of dozens of people.</span>
<span class="gi">+</span>
<span class="gi">+Although BeeKeeper was written to meet the needs of the BeeWare project,</span>
<span class="gi">+it&#39;s an open source tool available for anyone to use. If you&#39;d like to</span>
<span class="gi">+take BeeKeeper for a spin, come along to the sprints, or [check out the</span>
<span class="gi">+code on GitHub](https://github.com/beeware/beekeeper).</span>
<span class="gi">+</span>
<span class="gi">+BeeKeeper is also an example of the sort of product you&#39;d see more of if</span>
<span class="gi">+BeeWare development was funded full time. I was able to build BeeKeeper</span>
<span class="gi">+because I had a spare couple of weeks between jobs. There is no end to</span>
<span class="gi">+the tools and libraries like BeeKeeper and Waggle that could be built to</span>
<span class="gi">+support the software development process - all that is missing is the</span>
<span class="gi">+resources needed to develop those tools. If you&#39;d like to see more tools</span>
<span class="gi">+like BeeKeeper in the world, please consider [joining the BeeWare</span>
<span class="gi">+project as a financial member](/membership/). Every little</span>
<span class="gi">+bit helps, and if we can reach a critical mass of supporters, I&#39;ll be</span>
<span class="gi">+able to start working on BeeWare full time.</span>
<span class="w"> </span>
<span class="w"> </span>---
<span class="w"> </span>pub_date: 2017-07-31
</pre></div>
</small>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              </div>
            </div>
            <!-- End Modal content -->
          </div>
        </div>
        <!-- End Modal -->
<div class="row-fluid">
  <div class="col-sm-12 col-md-10 col-lg-8" >
  

  
  

  
  <p>Escribir suites de pruebas es una habilidad que es una parte vital del
entrenamiento de los programadores. Aprender a escribir buenas pruebas
le ayuda a escribir un código más robusto y asegura que cuando haya
escrito un código que funcione, siga trabajando durante mucho tiempo en
el futuro. También puede ayudarle a escribir mejor código en primer
lugar. Resulta que el código bien diseñado, con alta cohesión y bajo
acoplamiento, también es fácil de probar - por lo que escribir código
que sea fácil de probar casi siempre dará como resultado una mejor
calidad total del código.</p>
<p>Un paso importante en la "nivelación" de su experiencia de pruebas es
comenzar a usar un servicio de integración continua o CI. Un servicio de
CI es una herramienta que ejecuta automáticamente su suite de pruebas
cada vez que alguien realiza un cambio o cada vez que alguien propone un
cambio en forma de una solicitud de PR. El uso de un servicio de CI
garantiza que su código <em>siempre</em> pase su suite de pruebas - no puede
introducirse accidentalmente en un cambio que rompe una prueba, porque
obtendrá una notificación de advertencia roja grande.</p>
<p>Un CI es un servicio tan importante que muchas empresas sólo existen
para proporcionar CI-as-a-service. El proyecto BeeWare ha utilizado,
para diversos proyectos, <a href="https://travis-ci.com">TravisCI</a> y
<a href="https://circleci.com">CircleCI</a>. Ambas herramientas proporcionan
niveles gratuitos para proyectos de código abierto y han patrocinado
generosamente BeeWare con actualizaciones de capacidad en varias
ocasiones.</p>
<p>Sin embargo, BeeWare ha tenido una relación interesante con los
servicios comerciales de CI. Esto es por dos razones.</p>
<p>En primer lugar, nuestros conjuntos de pruebas, especialmente para
<a href="/es/proyecto/proyectos/puentes/voc">VOC</a> y
<a href="/es/proyecto/proyectos/puentes/batavia">Batavia</a> - toman mucho tiempo
para ejecutarse. Estos dos proyectos requieren pruebas que inician y
cierran repetidamente las máquinas virtuales (para Java y JavaScript,
respectivamente), y no importa cuánto se optimice el código que se está
probando, el tiempo de inicio y apagado de una máquina virtual
eventualmente se acumula. También necesitamos ejecutar nuestras suites
de prueba en múltiples versiones de Python - en la actualidad,
soportamos Python 3.4, 3.5 y 3.6, con 3.7 en el horizonte. También hay
cambios sutiles en versiones micro que pueden requerir pruebas.</p>
<p>Hemos sido capaces de acelerar las prueba, dividiendo la suite de
pruebas y ejecutando partes de la suite en paralelo, pero eso nos obliga
a enfrentarnos al segundo problema. Los servicios comerciales de CI
suelen operar en un modelo de suscripción; mayores suscripciones que
proporcionan más recursos simultáneos. Sin embargo, nuestro patrón de
uso es muy inusual. La mayor parte del año, recibimos un goteo lento de
solicitudes de PRs que requieren pruebas. Sin embargo, un par de veces
al año, tenemos un gran sprint, y tenemos una avalancha de
contribuciones durante un corto período de tiempo. En PyCon EE.UU.,
hemos tenido grupos de 40 personas presentando parches - y todos ellos
necesitan sus PRs probados por CI. Y el tiempo es un factor - los
sprints sólo duran un par de días, por lo que un rápido cambio en las
pruebas es esencial.</p>
<p>Si tuviéramos que suscribir a los niveles de suscripción de nivel
superior de CircleCi y TravisCI, todavía no tendríamos suficientes
recursos para soportar un sprint - pero estaríamos <em>masivamente</em> sobre
abastecidos en recursos durante el resto del año. También tendríamos que
pagar $ 750 o más por mes por este servicio, que es un presupuesto que
no podemos permitirnos.</p>
<p>Así que tuvimos un problema. Para ejecutar nuestra suite de pruebas de
manera eficaz, necesitábamos recursos paralelizados masivamente para
ejecutar una suite de pruebas rápidamente; y en ciertas épocas del año,
necesitamos un número extremadamente grande de estos recursos.</p>
<p>También teníamos otras tareas automatizadas que queríamos realizar.
Queríamos hacer linting del código (comprobación automatizada de estilo
de código) antes de que se probara un PR. Queríamos verificar la
ortografía de la documentación. Y queríamos que estas tareas se
retroalimentaran en GitHub como comentarios automatizados y marcadores
de estado de revisión de código específicos, informando a los
colaboradores no sólo de que se había producido un problema, sino de qué
problema y dónde estaban en su código.</p>
<p>También queríamos administrar las compilaciones de pipeline - no tiene
sentido hacer una prueba completa de varias versiones de Python una vez
que haya establecido que las pruebas están fallando en una versión. Y no
hay punto en hacer pruebas <em>en absoluto</em> si hay problemas de estilo de
código.</p>
<p>También queríamos hacer cosas que no eran sólo pruebas. Queríamos
verificar que se firmaron acuerdos de contribución. Queríamos
automatizar el despliegue de sitios web y documentación.</p>
<p>Lo que teníamos no era sólo un problema de CI. Era un problema donde
queríamos ejecutar automáticamente código arbitrario, de manera segura,
en respuesta a un evento GitHub.</p>
<p>He estado tratando de encontrar un servicio de CI que pueda satisfacer
nuestras necesidades durante más de un año. Pero durante el último año,
algunos pensamientos comenzaron a congelarse en mi cabeza.</p>
<ul>
<li>Amazon proporciona una API (EC2) que le permite arrancar máquinas de
complejidad variable (hasta 64 CPUs, con casi 500 GB de RAM) y pagar
por minuto para ese uso.</li>
<li>Docker proporciona las herramientas para configurar, lanzar y ejecutar
código de manera aislada</li>
<li>Amazon también proporciona una API (ECS) para controlar la ejecución
de los contenedores Docker.</li>
</ul>
<p>No hay nada específico acerca de AWS EC2 o ECS tampoco - se podría
utilizar Linode y Kubernetes, o Docker Swarm o Microsoft Azure ...
simplemente se necesita tener la capacidad de filtrar fácilmente las
máquinas y ejecutar un contenedor Docker. Después de todo: un conjunto
de pruebas es sólo un contenedor Docker que ejecuta un script que inicia
su suite de pruebas. Una revisión de linting es un contenedor de Docker
que ejecuta un script que lints su código. Una verificación de acuerdo
de contribuyente es un contenedor de Docker que comprueba los metadatos
asociados con una solicitud de extracción.</p>
<p>Todo lo que necesita es un sitio web que puede recibir las
notificaciones de eventos de GitHub e iniciar los contenedores de Docker
en respuesta.</p>
<p>A principios de julio, me encontré entre trabajos, y pronuncié la
fatídica pregunta: "¿Cuán difícil podría ser?" Y así, hoy, estoy
anunciando <a href="/es/proyecto/proyectos/herramientas/beekeeper">BeeKeeper</a> -
el propio servicio de CI de BeeWare.</p>
<p>BeeKeeper se despliega como un sitio web de Heroku, escrito con Django.
Después de configurarlo con las credenciales de Github y AWS, escucha
los webhooks de Github. Cuando se detecta una solicitud de pull o Push,
BeeKeeper crea una solicitud de generación; que la solicitud de
construcción inspecciona el código en el repositorio en busca de un
archivo de configuración <code>beekeeper.yml</code>. Ese archivo de configuración
describe el pipeline de tareas que se van a realizar, y para cada tarea,
el tipo de máquina que se debe usar, las variables de entorno que se
requieran y la imagen de Docker que se utilizará.</p>
<p>BeeKeeper también permite al administrador del sitio describir qué
recursos se utilizarán para satisfacer las compilaciones. Una tarea
puede decir que necesita una instancia de "Alta CPU"; pero la instancia
BeeKeeper puede determinar lo que significa "alta CPU" - ¿es 4 CPUs o
32? ¿Cuándo esas máquinas son coladas hacia arriba, cuánto tiempo se les
permitirá sentarse inactivo antes de ser apagado de nuevo? ¿Cuántas
máquinas deben estar permanentemente en el grupo de trabajo? ¿Y cuál es
el límite superior de las máquinas que se iniciará?</p>
<p>Una herramienta complementaria para BeeKeeper es
<a href="/es/proyecto/proyectos/atico/waggle">Waggle</a>. Waggle es una herramienta
que prepara una definición local de una tarea para que pueda ser
utilizada por BeeKeeper - compila la imagen de Docker y la carga en ECS
para que pueda ser referenciada por tareas. (Se llama "Waggle" porque
cuando las abejas obreras descubren una buena fuente de néctar, regresan
a la colmena y hacen una 'danza' que le dice a otras abejas cómo hacer
para encontrar esa fuente).</p>
<p>También hemos proporcionado un repositorio llamado
<a href="https://github.com/beeware/comb">Comb</a> (nombrado después del peine de
miel, las abejas del lugar almacenan todo el néctar que encuentran) que
define las configuraciones de la tarea que una instancia de BeeKeeper
puedo usar. Hemos proporcionado algunas definiciones simples como parte
del repositorio base de Comb; cada implementación de BeeKeeper debe
tener uno de estos repositorios propios.</p>
<p>Todavía hay mucho trabajo por hacer, pero ya estamos usando BeeKeeper
con Batavia y VOC, y la próxima PyCon AU sprints será nuestra primera en
condiciones de alta carga. Algunos cálculos de respaldo prevén que por
alrededor de $50, podremos proporcionar suficientes recursos de CPU para
cada ejecución de prueba para completar su ejecución en 10 minutos o
menos, soportando un sprint de decenas de personas.</p>
<p>Aunque BeeKeeper fue escrito para satisfacer las necesidades del
proyecto BeeWare, es una herramienta de código abierto disponible para
cualquier persona. Si desea tomar BeeKeeper para darle una prueba, vaya
a los sprints, o <a href="https://github.com/beeware/beekeeper">revise el código en
GitHub</a>.</p>
<p>BeeKeeper también es un ejemplo del tipo de producto que vería más si el
desarrollo de BeeWare se financiara a tiempo completo. Fui capaz de
construir BeeKeeper porque tenía un par de semanas de descanso entre los
trabajos. No hay fin para las herramientas y bibliotecas como BeeKeeper
y Waggle que podrían ser construidas para soportar el proceso de
desarrollo de software - todo lo que falta son los recursos necesarios
para desarrollar esas herramientas. Si desea ver más herramientas como
BeeKeeper en el mundo, considere la posibilidad de unirse al proyecto
BeeWare como <a href="/es/contribuir/membresia/">miembro financiero</a>. Cada
pedacito ayuda, y si podemos alcanzar a una masa crítica de
patrocinadores, podré comenzar a trabajar en BeeWare a tiempo completo.</p>


  </div>
  <div class="hidden-sm-down col-md-2 col-lg-4"></div>

  <div class="col-sm-12 col-md-4 gutter">
    <dl>
      
      <dt>
Siguiente entrada
</dt>
      <dd><a href="/es/noticias/zumbido/2017-google-verano-de-codigo-final-informe-jonas-schell/">2017 Google Summer of Code - Probando Toga / API de configuración</a></dd>
      

      
      <dt>
Anterior entrada
</dt>
      <dd><a href="/es/noticias/zumbido/una-solicitud-de-ayuda/">Una solicitud de ayuda</a></dd>
      
    </dl>
  </div></div>
</div>
    </div>

    <footer class="footer">
      <div class="container text-muted">
	      <div class="d-block d-sm-none copyright">&copy; Russell Keith-Magee 2025</div>
	      <div class="float-right clearfix d-sm-block d-none">&copy; Russell Keith-Magee 2025</div>
        <p class="d-sm-block d-none">
          <a href="https://github.com/beeware/"><i class="fa fa-github fa-lg" aria-hidden="true"></i> GitHub</a> |
          <a href="https://beeware.org/bee/chat/"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i> Discord</a> |
          <a href="https://fosstodon.org/@beeware"><i class="fa-brands fa-mastodon fa-lg" aria-hidden="true"></i> Mastodon</a> |
          <a href="/es/mapa-del-sitio/"><i class="fa fa-sitemap fa-lg" aria-hidden="true"></i> 
Mapa del Sitio
</a>
        </p>
        <p class="d-block d-sm-none footer-social">
          <a href="https://github.com/beeware/"><i class="fa fa-github fa-lg" aria-hidden="true"></i> GitHub</a> |
          <a href="https://beeware.org/bee/chat/"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i> Discord</a> |
          <a rel="me" href="https://fosstodon.org/@beeware"><i class="fa-brands fa-mastodon fa-lg" aria-hidden="true"></i> Mastodon</a>
        </p>
        <p class="d-block d-sm-none footer-sitemap">
          <a href="/es/mapa-del-sitio/"><i class="fa fa-sitemap fa-lg" aria-hidden="true"></i> 
Mapa del Sitio
</a>
        </p>
        
        
          
        <a rel="me" href="https://cloudisland.nz/@freakboy3742" style="display:none" ></a>
          
        
          
        <a rel="me" href="https://cloudisland.nz/@glasnt" style="display:none" ></a>
          
        
          
        <a rel="me" href="https://phildini.net/@phildini" style="display:none" ></a>
          
        
          
        <a rel="me" href="https://tweets.icu/@chris_swenson" style="display:none" ></a>
          
        
          
        
          
        
          
        <a rel="me" href="https://hachyderm.io/@cflee" style="display:none" ></a>
          
        
          
        <a rel="me" href="https://hachyderm.io/@charlotte" style="display:none" ></a>
          
        
          
        <a rel="me" href="https://fosstodon.org/@danyeaw" style="display:none" ></a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </footer>

    <!-- jQuery first, then Bootstrap JS. -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>

    <script src="/static/tether-1.3.3/js/tether.min.js"></script>
    <script src="/static/bootstrap/js/bootstrap.min.js"></script></body>
</html>
